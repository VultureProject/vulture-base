
template(name="haproxy_tcp" type="list") {
    constant(value="{")
    constant(value="\"@timestamp\": \"")                     property(name="$!timestamp")
    constant(value="\", \"date_time\": \"")                  property(name="$!date_time")
    constant(value="\", \"bytes_read\": ")                   property(name="$!bytes_read")
    constant(value=", \"hostname\": \"")                     property(name="$!hostname" format="json")
    constant(value="\", \"unique_id\": \"")                  property(name="$!unique_id")
    constant(value="\", \"status_code\": ")                  property(name="$!status_code")
    constant(value=", \"handshake_time\": ")                 property(name="$!handshake_time")
    constant(value=", \"unix_timestamp\": ")                 property(name="$!unix_timestamp")
    constant(value=", \"bytes_received\": ")                 property(name="$!bytes_received")
    constant(value=", \"active_conn\": ")                    property(name="$!active_conn")
    constant(value=", \"backend_name\": \"")                 property(name="$!backend_name" format="json")
    constant(value="\", \"beconn\": ")                       property(name="$!beconn")
    constant(value=", \"backend_ip\": \"")                   property(name="$!backend_ip")
    constant(value="\", \"backend_port\": ")                 property(name="$!backend_port")
    constant(value=", \"backend_queue\": ")                  property(name="$!backend_queue")
    constant(value=", \"src_ip\": \"")                       property(name="$!src_ip")
    constant(value="\", \"src_port\": ")                     property(name="$!src_port")
    constant(value=", \"frontend_name\": \"")                property(name="$!frontend_name" format="json")
    constant(value="\", \"feconn\": ")                       property(name="$!feconn")
    constant(value=", \"frontend_ip\": \"")                  property(name="$!frontend_ip")
    constant(value="\", \"frontend_port\": ")                property(name="$!frontend_port")
    constant(value=", \"pid\": ")                            property(name="$!pid")
    constant(value=", \"retries\": ")                        property(name="$!retries")
    constant(value=", \"request_count\": ")                  property(name="$!request_count")
    constant(value=", \"server_name\": \"")                  property(name="$!server_name" format="json")
    constant(value="\", \"srvconn\": ")                      property(name="$!srvconn")
    constant(value=", \"server_ip\": \"")                    property(name="$!server_ip")
    constant(value="\", \"server_port\": ")                  property(name="$!server_port")
    constant(value=", \"server_queue\": ")                   property(name="$!server_queue")
    constant(value=", \"termination_state\": \"")            property(name="$!termination_state")
    constant(value="\", \"tags\": \"")                       property(name="$!iplocation!reputation" format="json")
    constant(value="\", \"location\": \"")                   property(name="$!iplocation!country!iso_code" format="json")
    constant(value="\", \"ctx_tags\": \"")                   property(name="$!ctx_tags" format="json")
    constant(value="\", \"advens\": ")                       property(name="$!advens")
    constant(value="}\n")
}

template(name="haproxy_tcp_redis" type="list") {
    constant(value="{")
    constant(value="\"@timestamp\": \"")                     property(name="$!timestamp")
    constant(value="\", \"date_time\": \"")                  property(name="$!date_time")
    constant(value="\", \"bytes_read\": ")                   property(name="$!bytes_read")
    constant(value=", \"hostname\": \"")                     property(name="$!hostname" format="json")
    constant(value="\", \"unique_id\": \"")                  property(name="$!unique_id")
    constant(value="\", \"status_code\": ")                  property(name="$!status_code")
    constant(value=", \"handshake_time\": ")                 property(name="$!handshake_time")
    constant(value=", \"unix_timestamp\": ")                 property(name="$!unix_timestamp")
    constant(value=", \"bytes_received\": ")                 property(name="$!bytes_received")
    constant(value=", \"active_conn\": ")                    property(name="$!active_conn")
    constant(value=", \"backend_name\": \"")                 property(name="$!backend_name" format="json")
    constant(value="\", \"beconn\": ")                       property(name="$!beconn")
    constant(value=", \"backend_ip\": \"")                   property(name="$!backend_ip")
    constant(value="\", \"backend_port\": ")                 property(name="$!backend_port")
    constant(value=", \"backend_queue\": ")                  property(name="$!backend_queue")
    constant(value=", \"src_ip\": \"")                       property(name="$!src_ip")
    constant(value="\", \"src_port\": ")                     property(name="$!src_port")
    constant(value=", \"frontend_name\": \"")                property(name="$!frontend_name" format="json")
    constant(value="\", \"feconn\": ")                       property(name="$!feconn")
    constant(value=", \"frontend_ip\": \"")                  property(name="$!frontend_ip")
    constant(value="\", \"frontend_port\": ")                property(name="$!frontend_port")
    constant(value=", \"pid\": ")                            property(name="$!pid")
    constant(value=", \"retries\": ")                        property(name="$!retries")
    constant(value=", \"request_count\": ")                  property(name="$!request_count")
    constant(value=", \"server_name\": \"")                  property(name="$!server_name" format="json")
    constant(value="\", \"srvconn\": ")                      property(name="$!srvconn")
    constant(value=", \"server_ip\": \"")                    property(name="$!server_ip")
    constant(value="\", \"server_port\": ")                  property(name="$!server_port")
    constant(value=", \"server_queue\": ")                   property(name="$!server_queue")
    constant(value=", \"termination_state\": \"")            property(name="$!termination_state")
    constant(value="\", \"tags\": \"")                       property(name="$!iplocation!reputation" format="json")
    constant(value="\", \"location\": \"")                   property(name="$!iplocation!country!iso_code" format="json")
    constant(value="\", \"ctx_tags\": \"")                   property(name="$!ctx_tags" format="json")
    constant(value="\", \"advens\": ")                       property(name="$!advens")
    constant(value="}")
}

template(name="haproxy_tcp_mongo" type="list") {
    property(name="$!time-utc" outName="time")
    property(name="$!date_time")
    property(name="$!bytes_read")
    property(name="$!hostname")
    property(name="$!unique_id")
    property(name="$!status_code")
    property(name="$!http_request_time")
    property(name="$!handshake_time")
    property(name="$!http_receive_time")
    property(name="$!http_response_time")
    property(name="$!unix_timestamp")
    property(name="$!bytes_received")
    property(name="$!active_conn")
    property(name="$!backend_name")
    property(name="$!beconn")
    property(name="$!backend_ip")
    property(name="$!backend_port")
    property(name="$!backend_queue")
    property(name="$!src_ip")
    property(name="$!src_port")
    property(name="$!frontend_name")
    property(name="$!feconn")
    property(name="$!frontend_ip")
    property(name="$!frontend_port")
    property(name="$!pid")
    property(name="$!retries")
    property(name="$!request_count")
    property(name="$!server_name")
    property(name="$!srvconn")
    property(name="$!server_ip")
    property(name="$!server_port")
    property(name="$!server_queue")
    property(name="$!termination_state")
    property(name="$!iplocation!reputation" outname="tags")
    property(name="$!iplocation!country!iso_code" outname="country")
    property(name="$!ctx_tags")
    property(name="$!advens")
}
