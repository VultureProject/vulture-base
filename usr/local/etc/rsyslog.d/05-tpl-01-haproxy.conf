
template(name="haproxy" type="list") {
    constant(value="{")
    constant(value="\"@timestamp\": \"")                     property(name="$!timestamp")
    constant(value="\", \"date_time\": \"")                  property(name="$!date_time")
    constant(value="\", \"bytes_read\": ")                   property(name="$!bytes_read")
    constant(value=", \"captured_request_cookie\": \"")      property(name="$!captured_request_cookie" format="json")
    constant(value="\", \"captured_response_cookie\": \"")   property(name="$!captured_response_cookie" format="json")
    constant(value="\", \"hostname\": \"")                   property(name="$!hostname" format="json")
    constant(value="\", \"http_method\": \"")                property(name="$!http_method" format="json")
    constant(value="\", \"http_path\": \"")                  property(name="$!http_path" format="json")
    constant(value="\", \"http_get_params\": \"")            property(name="$!http_get_params" format="json")
    constant(value="\", \"http_version\": \"")               property(name="$!http_version" format="json")
    constant(value="\", \"http_user_agent\": \"")            property(name="$!http_user_agent" format="json")
    constant(value="\", \"http_request_cookies\": \"")       property(name="$!http_request_cookies" format="json")
    constant(value="\", \"http_request_body\": \"")          property(name="$!http_request_body" format="json")
    constant(value="\", \"http_request_content_type\": \"")  property(name="$!http_request_content_type" format="json")
    constant(value="\", \"http_request_host\": \"")          property(name="$!http_request_host" format="json")
    constant(value="\", \"unique_id\": \"")                  property(name="$!unique_id")
    constant(value="\", \"status_code\": ")                  property(name="$!status_code")
    constant(value=", \"http_request_time\": ")              property(name="$!http_request_time")
    constant(value=", \"http_idle_time\": ")                 property(name="$!http_idle_time")
    constant(value=", \"handshake_time\": ")                 property(name="$!handshake_time")
    constant(value=", \"unix_timestamp\": ")                 property(name="$!unix_timestamp")
    constant(value=", \"bytes_received\": ")                 property(name="$!bytes_received")
    constant(value=", \"active_conn\": ")                    property(name="$!active_conn")
    constant(value=", \"backend_name\": \"")                 property(name="$!backend_name" format="json")
    constant(value="\", \"beconn\": ")                       property(name="$!beconn")
    constant(value=", \"backend_ip\": \"")                   property(name="$!backend_ip")
    constant(value="\", \"backend_port\": ")                 property(name="$!backend_port")
    constant(value=", \"backend_queue\": ")                  property(name="$!backend_queue")
    constant(value=", \"src_ip\": \"")                       property(name="$!src_ip")
    constant(value="\", \"src_port\": ")                     property(name="$!src_port")
    constant(value=", \"frontend_name\": \"")                property(name="$!frontend_name" format="json")
    constant(value="\", \"feconn\": ")                       property(name="$!feconn")
    constant(value=", \"frontend_ip\": \"")                  property(name="$!frontend_ip")
    constant(value="\", \"frontend_port\": ")                property(name="$!frontend_port")
    constant(value=", \"pid\": ")                            property(name="$!pid")
    constant(value="\", \"retries\": ")                      property(name="$!retries")
    constant(value=", \"request_count\": ")                  property(name="$!request_count")
    constant(value=", \"server_name\": \"")                  property(name="$!server_name" format="json")
    constant(value="\", \"srvconn\": ")                      property(name="$!srvconn")
    constant(value=", \"server_ip\": \"")                    property(name="$!server_ip")
    constant(value="\", \"server_port\": ")                  property(name="$!server_port")
    constant(value=", \"server_queue\": ")                   property(name="$!server_queue")
    constant(value=", \"termination_state\": \"")            property(name="$!termination_state")
    constant(value="\", \"tags\": \"")                       property(name="$!iplocation!reputation" format="json")
    constant(value="\", \"location\": \"")                   property(name="$!iplocation!country!iso_code" format="json")
    constant(value="\", \"ctx_tags\": \"")                   property(name="$!ctx_tags" format="json")
    constant(value="\", \"defender_score\": \"")             property(name="$!defender_score")
    constant(value="\", \"darwin_session_error\": \"")       property(name="$!darwin_session_error")
    constant(value="\", \"darwin_session_score\": \"")       property(name="$!darwin_session_score")
    constant(value="\", \"advens\": ")                       property(name="$!advens")
    constant(value="}\n")
}

template(name="haproxy_redis" type="list") {
    constant(value="{")
    constant(value="\"@timestamp\": \"")                     property(name="$!timestamp")
    constant(value="\", \"date_time\": \"")                  property(name="$!date_time")
    constant(value="\", \"bytes_read\": ")                   property(name="$!bytes_read")
    constant(value=", \"captured_request_cookie\": \"")      property(name="$!captured_request_cookie" format="json")
    constant(value="\", \"captured_response_cookie\": \"")   property(name="$!captured_response_cookie" format="json")
    constant(value="\", \"hostname\": \"")                   property(name="$!hostname" format="json")
    constant(value="\", \"http_method\": \"")                property(name="$!http_method" format="json")
    constant(value="\", \"http_path\": \"")                  property(name="$!http_path" format="json")
    constant(value="\", \"http_get_params\": \"")            property(name="$!http_get_params" format="json")
    constant(value="\", \"http_version\": \"")               property(name="$!http_version" format="json")
    constant(value="\", \"http_user_agent\": \"")            property(name="$!http_user_agent" format="json")
    constant(value="\", \"http_request_cookies\": \"")       property(name="$!http_request_cookies" format="json")
    constant(value="\", \"http_request_body\": \"")          property(name="$!http_request_body" format="json")
    constant(value="\", \"http_request_content_type\": \"")  property(name="$!http_request_content_type" format="json")
    constant(value="\", \"unique_id\": \"")                  property(name="$!unique_id")
    constant(value="\", \"status_code\": ")                  property(name="$!status_code")
    constant(value=", \"http_request_time\": ")              property(name="$!http_request_time")
    constant(value=", \"http_idle_time\": ")                 property(name="$!http_idle_time")
    constant(value=", \"handshake_time\": ")                 property(name="$!handshake_time")
    constant(value=", \"unix_timestamp\": ")                 property(name="$!unix_timestamp")
    constant(value=", \"bytes_received\": ")                 property(name="$!bytes_received")
    constant(value=", \"active_conn\": ")                    property(name="$!active_conn")
    constant(value=", \"backend_name\": \"")                 property(name="$!backend_name" format="json")
    constant(value="\", \"beconn\": ")                       property(name="$!beconn")
    constant(value=", \"backend_ip\": \"")                   property(name="$!backend_ip")
    constant(value="\", \"backend_port\": ")                 property(name="$!backend_port")
    constant(value=", \"backend_queue\": ")                  property(name="$!backend_queue")
    constant(value=", \"src_ip\": \"")                       property(name="$!src_ip")
    constant(value="\", \"src_port\": ")                     property(name="$!src_port")
    constant(value=", \"frontend_name\": \"")                property(name="$!frontend_name" format="json")
    constant(value="\", \"feconn\": ")                       property(name="$!feconn")
    constant(value=", \"frontend_ip\": \"")                  property(name="$!frontend_ip")
    constant(value="\", \"frontend_port\": ")                property(name="$!frontend_port")
    constant(value=", \"pid\": ")                            property(name="$!pid")
    constant(value=", \"http_request\": \"")                 property(name="$!http_request")
    constant(value="\", \"retries\": ")                      property(name="$!retries")
    constant(value=", \"request_count\": ")                  property(name="$!request_count")
    constant(value=", \"server_name\": \"")                  property(name="$!server_name" format="json")
    constant(value="\", \"srvconn\": ")                      property(name="$!srvconn")
    constant(value=", \"server_ip\": \"")                    property(name="$!server_ip")
    constant(value="\", \"server_port\": ")                  property(name="$!server_port")
    constant(value=", \"server_queue\": ")                   property(name="$!server_queue")
    constant(value=", \"termination_state\": \"")            property(name="$!termination_state")
    constant(value="\", \"tags\": \"")                       property(name="$!iplocation!reputation" format="json")
    constant(value="\", \"location\": \"")                   property(name="$!iplocation!country!iso_code" format="json")
    constant(value="\", \"ctx_tags\": \"")                   property(name="$!ctx_tags" format="json")
    constant(value="\", \"defender_score\": \"")             property(name="$!defender_score")
    constant(value="\", \"advens\": ")                       property(name="$!advens")
    constant(value="}")
}

template(name="haproxy_mongo" type="list") {
    property(name="$!timestamp" outName="time")
    property(name="$!date_time")
    property(name="$!bytes_read")
    property(name="$!captured_request_cookie")
    property(name="$!captured_response_cookie")
    property(name="$!hostname")
    property(name="$!http_method")
    property(name="$!http_path")
    property(name="$!http_get_params")
    property(name="$!http_version")
    property(name="$!http_user_agent")
    property(name="$!http_request_body")
    property(name="$!http_request_cookies")
    property(name="$!http_request_content_type")
    property(name="$!unique_id")
    property(name="$!status_code")
    property(name="$!http_request_time")
    property(name="$!http_idle_time")
    property(name="$!handshake_time")
    property(name="$!http_receive_time")
    property(name="$!http_response_time")
    property(name="$!unix_timestamp")
    property(name="$!bytes_received")
    property(name="$!active_conn")
    property(name="$!backend_name")
    property(name="$!beconn")
    property(name="$!backend_ip")
    property(name="$!backend_port")
    property(name="$!backend_queue")
    property(name="$!src_ip")
    property(name="$!src_port")
    property(name="$!frontend_name")
    property(name="$!feconn")
    property(name="$!frontend_ip")
    property(name="$!frontend_port")
    property(name="$!pid")
    property(name="$!http_request")
    property(name="$!retries")
    property(name="$!request_count")
    property(name="$!server_name")
    property(name="$!srvconn")
    property(name="$!server_ip")
    property(name="$!server_port")
    property(name="$!server_queue")
    property(name="$!termination_state")
    property(name="$!iplocation!reputation" outname="tags")
    property(name="$!iplocation!country!iso_code" outname="country")
    property(name="$!ctx_tags")
    property(name="$!defender_score")
    property(name="$!advens")
}
